<Page
    x:Class="RemoteLogViewer.Views.SshSession.SshServerSelectorPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:sshVm="using:RemoteLogViewer.ViewModels.Ssh"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">
	<Grid Padding="12">
		<Grid.ColumnDefinitions>
			<ColumnDefinition Width="Auto" />
			<ColumnDefinition Width="*" />
		</Grid.ColumnDefinitions>
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto" />
			<RowDefinition Height="*" />
		</Grid.RowDefinitions>
		<StackPanel>
			<TextBlock Grid.Column="0" Grid.Row="0" Text="Saved Connections" Margin="0,12,0,0" FontWeight="SemiBold" />
			<Button Content="+" Command="{x:Bind ViewModel.AddSavedConnectionsCommand, Mode=OneWay}" />
		</StackPanel>
		<ListBox Grid.Column="0" Grid.Row="1"
                 ItemsSource="{x:Bind ViewModel.SavedConnections}"
                 DoubleTapped="SavedConnections_DoubleTapped"
                 SelectionChanged="SavedConnections_SelectionChanged"
                 ScrollViewer.VerticalScrollMode="Auto"
                 ScrollViewer.VerticalScrollBarVisibility="Auto"
				 SelectedItem="{x:Bind ViewModel.SelectedSshConnectionInfo.Value,Mode=OneWay}">
			<ListBox.ItemTemplate>
				<DataTemplate x:DataType="sshVm:SshConnectionInfoViewModel">
					<TextBlock Text="{x:Bind DisplayName.Value,Mode=OneWay}" />
				</DataTemplate>
			</ListBox.ItemTemplate>
		</ListBox>
		<StackPanel Grid.Column="1" Grid.RowSpan="2" Spacing="8" Visibility="{x:Bind ViewModel.SelectedSshConnectionInfo.Value, Mode=OneWay, Converter={StaticResource NullToVisibilityConverter}}">
			<TextBox Header="Name" Text="{x:Bind ViewModel.SelectedSshConnectionInfo.Value.Name.Value,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
			<TextBox Header="Host" Text="{x:Bind ViewModel.SelectedSshConnectionInfo.Value.Host.Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
			<NumberBox Header="Port" Value="{x:Bind ViewModel.SelectedSshConnectionInfo.Value.Port.Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Minimum="1" Maximum="65535" />
			<TextBox Header="User" Text="{x:Bind ViewModel.SelectedSshConnectionInfo.Value.User.Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
			<TextBox Header="Password" Text="{x:Bind ViewModel.SelectedSshConnectionInfo.Value.Password.Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
			<StackPanel>
				<TextBlock Text="Private Key Path" FontSize="12" />
				<StackPanel Orientation="Horizontal" Spacing="8">
					<TextBox Width="300" Text="{x:Bind ViewModel.SelectedSshConnectionInfo.Value.PrivateKeyPath.Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" PlaceholderText="C:\keys\private.key" />
					<Button Content="..." Click="BrowsePrivateKeyButton_Click" />
				</StackPanel>
			</StackPanel>
			<TextBox Header="Private Key Passphrase" Text="{x:Bind ViewModel.SelectedSshConnectionInfo.Value.PrivateKeyPassphrase.Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
			<ComboBox
				Header="Encoding"
				ItemsSource="{x:Bind ViewModel.AvailableEncodings,Mode=OneWay}"
				SelectedValue="{x:Bind ViewModel.SelectedSshConnectionInfo.Value.EncodingString.Value,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
			<StackPanel Orientation="Horizontal" Spacing="8">
				<Button Content="Test" Command="{x:Bind ViewModel.TestConnectCommand}" IsEnabled="{x:Bind ViewModel.SelectedSshConnectionInfo.Value.IsEdited.Value, Mode=OneWay, Converter={StaticResource BooleanNegationConverter}}" />
				<Button Content="Connect" Command="{x:Bind ViewModel.ConnectCommand}" IsEnabled="{x:Bind ViewModel.SelectedSshConnectionInfo.Value.IsEdited.Value, Mode=OneWay, Converter={StaticResource BooleanNegationConverter}}" />
				<Button Content="Save" Command="{x:Bind ViewModel.SelectedSshConnectionInfo.Value.SaveConnectionInfoCommand,Mode=OneWay}" />
				<Button Content="Remove" Command="{x:Bind ViewModel.SelectedSshConnectionInfo.Value.RemoveConnectionInfoCommand,Mode=OneWay}" />
			</StackPanel>
		</StackPanel>
	</Grid>
</Page>