<UserControl
	x:Class="RemoteLogViewer.Views.SshSessionControl"
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:vm="using:RemoteLogViewer.ViewModels"
	xmlns:sshVm="using:RemoteLogViewer.ViewModels.Ssh"
	xmlns:conv="using:RemoteLogViewer.Views.Converters"
	xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
	xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
	mc:Ignorable="d">
	<UserControl.Resources>
		<conv:BooleanToVisibilityConverter x:Key="BoolToVisibility" />
		<conv:InverseBooleanToVisibilityConverter x:Key="BoolToVisibilityInverse" />
	</UserControl.Resources>
	<Grid Padding="12">
		<!-- 接続設定ビュー -->
		<Grid Visibility="{x:Bind ViewModel.IsConnected.Value, Mode=OneWay,Converter={StaticResource BoolToVisibilityInverse}}">
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="Auto" />
				<ColumnDefinition Width="*" />
			</Grid.ColumnDefinitions>
			<Grid.RowDefinitions>
				<RowDefinition Height="Auto" />
				<RowDefinition Height="*" />
			</Grid.RowDefinitions>
			<StackPanel>
			<TextBlock
				Grid.Column="0"
				Grid.Row="0"
				Text="Saved Connections"
				Margin="0,12,0,0"
				FontWeight="SemiBold" />
				<Button Content="+" Command="{x:Bind ViewModel.AddSavedConnectionsCommand}"/>
			</StackPanel>

			<ListBox
				ScrollViewer.VerticalScrollMode="Auto"
				ScrollViewer.VerticalScrollBarVisibility="Auto"
				Grid.Column="0"
				Grid.Row="1"
				ItemsSource="{x:Bind ViewModel.SavedConnections}"
				DoubleTapped="SavedConnections_DoubleTapped">
				<ListBox.ItemTemplate>
					<DataTemplate x:DataType="sshVm:SshConnectionInfoViewModel">
						<Grid>
							<TextBlock Text="{x:Bind DisplayName.Value,Mode=OneWay}"/>
						</Grid>
					</DataTemplate>
				</ListBox.ItemTemplate>
			</ListBox>
			<StackPanel
				Grid.Column="1"
				Grid.RowSpan="2"
				Spacing="8">
				<TextBox Header="Host" Text="{x:Bind ViewModel.SelectedSshConnectionInfo.Value.Host.Value, Mode=TwoWay}" />
				<NumberBox Header="Port" Value="{x:Bind ViewModel.SelectedSshConnectionInfo.Value.Port.Value, Mode=TwoWay}" Minimum="1" Maximum="65535" />
				<TextBox Header="User" Text="{x:Bind ViewModel.SelectedSshConnectionInfo.Value.User.Value, Mode=TwoWay}" />
				<TextBox Header="Password" Text="{x:Bind ViewModel.SelectedSshConnectionInfo.Value.Password.Value, Mode=TwoWay}"/>
				<StackPanel Orientation="Horizontal" Spacing="8">
					<Button Content="Test" Command="{x:Bind ViewModel.TestConnectCommand}" />
					<Button Content="Connect" Command="{x:Bind ViewModel.ConnectCommand}" />
					<Button Content="Save" Command="{x:Bind ViewModel.SelectedSshConnectionInfo.Value.SaveConnectionInfoCommand,Mode=OneWay}" />
					<Button Content="Remove" Command="{x:Bind ViewModel.SelectedSshConnectionInfo.Value.RemoveConnectionInfoCommand,Mode=OneWay}" />
				</StackPanel>
			</StackPanel>
		</Grid>

		<!-- 接続後ビュー (ListView 表示) -->
		<StackPanel Visibility="{x:Bind ViewModel.IsConnected.Value, Mode=OneWay, Converter={StaticResource BoolToVisibility}}" Spacing="8">
			<TextBlock Text="Entries" FontWeight="SemiBold" />
			<ListView ItemsSource="{x:Bind ViewModel.Entries}" Height="300" />
		</StackPanel>
	</Grid>
</UserControl>